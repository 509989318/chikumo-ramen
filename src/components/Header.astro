---
import { nav, langCodes, recruitLink, facebookLink, instagramLink } from '../i18n/translations';
import type { Lang } from '../i18n/translations';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const t = nav[lang];
const currentLangCode = langCodes[lang];
const otherLangs = (Object.keys(langCodes) as Lang[]).filter(l => l !== lang);

const navItems = [
  { label: t.philosophy, href: `/${lang}/philosophy/` },
  { label: t.about, href: `/${lang}/about/` },
  { label: t.ourRamen, href: `/${lang}/our-ramen/` },
  { label: t.location, href: `/${lang}/location/` },
  { label: t.recruit, href: recruitLink, external: true },
  { label: t.gallery, href: `/${lang}/gallery/` },
  { label: t.contactUs, href: `/${lang}/contact-us/` },
];
---

<!-- Desktop Header -->
<header class="hidden lg:flex fixed top-0 left-0 w-full z-50 bg-white/95 backdrop-blur-sm items-center justify-between px-10 py-4">
  <a href={`/${lang}/`} class="flex-shrink-0">
    <img src="/wp-content/uploads/2023/11/Group-8.svg" alt="Chikumo" class="h-10" />
  </a>
  <nav class="flex items-center gap-6">
    {navItems.map(item => (
      <a
        href={item.href}
        class="nav-link"
        {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
      >
        {item.label}
      </a>
    ))}
    <div class="relative">
      <button id="lang-toggle" class="nav-link cursor-pointer flex items-center gap-1">
        {currentLangCode}
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
      </button>
      <div id="lang-dropdown" class="hidden absolute top-full right-0 mt-2 bg-white shadow-md rounded min-w-[60px] py-2 z-50">
        {otherLangs.map(l => (
          <a href={`/${l}/`} class="block px-4 py-1 text-sm text-gray-600 hover:text-[#FB720F]">
            {langCodes[l]}
          </a>
        ))}
      </div>
    </div>
  </nav>
</header>

<!-- Tablet Header -->
<header class="hidden md:flex lg:hidden fixed top-0 left-0 w-full z-50 bg-white/95 backdrop-blur-sm items-center justify-between px-6 py-3">
  <a href={`/${lang}/`}>
    <img src="/wp-content/uploads/2023/11/Group-8.svg" alt="Chikumo" class="h-8" />
  </a>
  <button id="menu-hamburger-tablet" class="flex flex-col gap-1.5 p-2" aria-label="Menu">
    <span class="w-6 h-0.5 bg-black/50"></span>
    <span class="w-6 h-0.5 bg-black/50"></span>
    <span class="w-6 h-0.5 bg-black/50"></span>
  </button>
</header>

<!-- Mobile Header -->
<header class="flex md:hidden fixed top-0 left-0 w-full z-50 bg-white/95 backdrop-blur-sm items-center justify-between px-4 py-3">
  <a href={`/${lang}/`}>
    <img src="/wp-content/uploads/2023/11/Group-8.svg" alt="Chikumo" class="h-7" />
  </a>
  <button id="menu-hamburger" class="flex flex-col gap-1.5 p-2" aria-label="Menu">
    <span class="w-6 h-0.5 bg-black/50"></span>
    <span class="w-6 h-0.5 bg-black/50"></span>
    <span class="w-6 h-0.5 bg-black/50"></span>
  </button>
</header>

<!-- Mobile Slide Menu -->
<div id="mobile-overlay" class="mobile-overlay"></div>
<nav id="mobile-menu" class="mobile-menu flex flex-col p-8 pt-16">
  <button id="menu-close" class="absolute top-4 right-4 text-gray-500 border border-gray-300 rounded px-2 py-1 text-sm bg-transparent cursor-pointer">X</button>
  <div class="flex flex-col gap-4 mt-4">
    <a href={`/${lang}/`} class="nav-link text-lg">{t.top}</a>
    {navItems.map(item => (
      <a
        href={item.href}
        class="nav-link text-lg"
        {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
      >
        {item.label}
      </a>
    ))}
    <div class="flex gap-4 mt-4 pt-4 border-t border-gray-200">
      {(Object.keys(langCodes) as Lang[]).map(l => (
        <a
          href={`/${l}/`}
          class:list={['nav-link', { 'font-bold text-black': l === lang }]}
        >
          {langCodes[l]}
        </a>
      ))}
    </div>
  </div>
</nav>

<!-- Spacer for fixed header -->
<div class="h-16 lg:h-20"></div>

<script>
  // Also handle tablet hamburger
  document.getElementById('menu-hamburger-tablet')?.addEventListener('click', () => {
    document.getElementById('mobile-menu')?.classList.add('active');
    document.getElementById('mobile-overlay')?.classList.add('active');
    document.body.style.overflow = 'hidden';
  });
</script>
